<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Champions HR - Deployment Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    h1 {
      color: #dc3545;
      border-bottom: 2px solid #dc3545;
      padding-bottom: 10px;
    }
    .test-section {
      margin-bottom: 30px;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .error {
      color: red;
      font-weight: bold;
    }
    button {
      padding: 10px 15px;
      background-color: #dc3545;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 10px;
      font-weight: bold;
    }
    button:hover {
      background-color: #c82333;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    pre {
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
      border: 1px solid #ddd;
    }
    .result {
      margin-top: 15px;
      padding: 15px;
      border-radius: 5px;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
    }
    .tabs {
      display: flex;
      margin-bottom: 20px;
    }
    .tab {
      padding: 10px 15px;
      cursor: pointer;
      background-color: #f1f1f1;
      border: 1px solid #ddd;
      border-bottom: none;
      border-radius: 5px 5px 0 0;
      margin-right: 5px;
    }
    .tab.active {
      background-color: #dc3545;
      color: white;
      font-weight: bold;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
  </style>
</head>
<body>
  <h1>Champions HR Services - Deployment Test</h1>
  
  <div class="tabs">
    <div class="tab active" onclick="openTab(event, 'localTest')">Local Test</div>
    <div class="tab" onclick="openTab(event, 'productionTest')">Production Test</div>
    <div class="tab" onclick="openTab(event, 'customTest')">Custom Test</div>
  </div>
  
  <div id="localTest" class="tab-content active">
    <div class="test-section">
      <h2>Test Local Backend</h2>
      <p>This will test your local backend server running at <code>http://localhost:5000</code>.</p>
      <button onclick="testBackend('http://localhost:5000')">Test Local Backend</button>
      <div id="localBackendResult" class="result"></div>
    </div>
    
    <div class="test-section">
      <h2>Test Local Email Sending</h2>
      <p>This will test sending an email through your local backend server.</p>
      <button onclick="testEmailSending('http://localhost:5000')">Send Test Email</button>
      <div id="localEmailResult" class="result"></div>
    </div>
  </div>
  
  <div id="productionTest" class="tab-content">
    <div class="test-section">
      <h2>Test Production Backend</h2>
      <p>This will test your production backend server running at <code>https://champions-hr-backend.onrender.com</code>.</p>
      <button onclick="testBackend('https://champions-hr-backend.onrender.com')">Test Production Backend</button>
      <div id="productionBackendResult" class="result"></div>
    </div>
    
    <div class="test-section">
      <h2>Test Production Email Sending</h2>
      <p>This will test sending an email through your production backend server.</p>
      <button onclick="testEmailSending('https://champions-hr-backend.onrender.com')">Send Test Email</button>
      <div id="productionEmailResult" class="result"></div>
    </div>
  </div>
  
  <div id="customTest" class="tab-content">
    <div class="test-section">
      <h2>Test Custom Backend</h2>
      <p>Enter a custom backend URL to test:</p>
      <input type="text" id="customBackendUrl" placeholder="Enter backend URL (e.g., http://192.168.1.30:5000)">
      <button onclick="testCustomBackend()">Test Custom Backend</button>
      <div id="customBackendResult" class="result"></div>
    </div>
    
    <div class="test-section">
      <h2>Test Custom Email Sending</h2>
      <p>Enter a custom backend URL to test email sending:</p>
      <input type="text" id="customEmailUrl" placeholder="Enter backend URL (e.g., http://192.168.1.30:5000)">
      <button onclick="testCustomEmail()">Send Test Email</button>
      <div id="customEmailResult" class="result"></div>
    </div>
  </div>
  
  <script>
    function openTab(evt, tabName) {
      const tabContents = document.getElementsByClassName("tab-content");
      for (let i = 0; i < tabContents.length; i++) {
        tabContents[i].classList.remove("active");
      }
      
      const tabs = document.getElementsByClassName("tab");
      for (let i = 0; i < tabs.length; i++) {
        tabs[i].classList.remove("active");
      }
      
      document.getElementById(tabName).classList.add("active");
      evt.currentTarget.classList.add("active");
    }
    
    async function testBackend(backendUrl) {
      const resultElementId = backendUrl.includes('localhost') ? 'localBackendResult' : 'productionBackendResult';
      const resultElement = document.getElementById(resultElementId);
      
      resultElement.innerHTML = '<p>Testing connection...</p>';
      
      try {
        const response = await fetch(`${backendUrl}/api/test`);
        const data = await response.json();
        
        resultElement.innerHTML = `
          <p class="success">Connection successful! ✅</p>
          <p>Status: ${response.status}</p>
          <p>Response:</p>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        `;
      } catch (error) {
        resultElement.innerHTML = `
          <p class="error">Connection failed! ❌</p>
          <p>Error: ${error.message}</p>
          <p>This could be due to:</p>
          <ul>
            <li>The server is not running</li>
            <li>CORS issues</li>
            <li>Network connectivity problems</li>
          </ul>
        `;
      }
    }
    
    async function testEmailSending(backendUrl) {
      const resultElementId = backendUrl.includes('localhost') ? 'localEmailResult' : 'productionEmailResult';
      const resultElement = document.getElementById(resultElementId);
      
      resultElement.innerHTML = '<p>Sending test email...</p>';
      
      try {
        const response = await fetch(`${backendUrl}/api/send-email`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            name: 'Test User',
            email: 'test@example.com',
            option: 'Deployment Test',
            contact: '1234567890',
            message: 'This is a test message from the deployment test page',
            timestamp: new Date().toISOString()
          }),
        });
        
        const data = await response.json();
        
        if (data.success) {
          resultElement.innerHTML = `
            <p class="success">Email sent successfully! ✅</p>
            <p>Response:</p>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
        } else {
          resultElement.innerHTML = `
            <p class="error">Email sending failed! ❌</p>
            <p>Response:</p>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
        }
      } catch (error) {
        resultElement.innerHTML = `
          <p class="error">Error: ${error.message} ❌</p>
          <p>This could be due to:</p>
          <ul>
            <li>The server is not running</li>
            <li>CORS issues</li>
            <li>Email configuration problems</li>
          </ul>
        `;
      }
    }
    
    function testCustomBackend() {
      const backendUrl = document.getElementById('customBackendUrl').value.trim();
      if (!backendUrl) {
        document.getElementById('customBackendResult').innerHTML = '<p class="error">Please enter a backend URL</p>';
        return;
      }
      
      testBackendCustom(backendUrl);
    }
    
    async function testBackendCustom(backendUrl) {
      const resultElement = document.getElementById('customBackendResult');
      
      resultElement.innerHTML = '<p>Testing connection...</p>';
      
      try {
        const response = await fetch(`${backendUrl}/api/test`);
        const data = await response.json();
        
        resultElement.innerHTML = `
          <p class="success">Connection successful! ✅</p>
          <p>Status: ${response.status}</p>
          <p>Response:</p>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        `;
      } catch (error) {
        resultElement.innerHTML = `
          <p class="error">Connection failed! ❌</p>
          <p>Error: ${error.message}</p>
          <p>This could be due to:</p>
          <ul>
            <li>The server is not running</li>
            <li>CORS issues</li>
            <li>Network connectivity problems</li>
          </ul>
        `;
      }
    }
    
    function testCustomEmail() {
      const backendUrl = document.getElementById('customEmailUrl').value.trim();
      if (!backendUrl) {
        document.getElementById('customEmailResult').innerHTML = '<p class="error">Please enter a backend URL</p>';
        return;
      }
      
      testEmailSendingCustom(backendUrl);
    }
    
    async function testEmailSendingCustom(backendUrl) {
      const resultElement = document.getElementById('customEmailResult');
      
      resultElement.innerHTML = '<p>Sending test email...</p>';
      
      try {
        const response = await fetch(`${backendUrl}/api/send-email`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            name: 'Test User',
            email: 'test@example.com',
            option: 'Custom Deployment Test',
            contact: '1234567890',
            message: 'This is a test message from the custom deployment test',
            timestamp: new Date().toISOString()
          }),
        });
        
        const data = await response.json();
        
        if (data.success) {
          resultElement.innerHTML = `
            <p class="success">Email sent successfully! ✅</p>
            <p>Response:</p>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
        } else {
          resultElement.innerHTML = `
            <p class="error">Email sending failed! ❌</p>
            <p>Response:</p>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
        }
      } catch (error) {
        resultElement.innerHTML = `
          <p class="error">Error: ${error.message} ❌</p>
          <p>This could be due to:</p>
          <ul>
            <li>The server is not running</li>
            <li>CORS issues</li>
            <li>Email configuration problems</li>
          </ul>
        `;
      }
    }
  </script>
</body>
</html>
